

        

<div id="visual">

    <div>
        <p>By clicking the below button "Visualize" a pop window will be displayed with the visualization of the data that you uploaded at the beginning of the procedure.</p>
        <a href="#" class="btn btn-primary" data-toggle="modal" data-target="#visualization" id="visualize">Visualize</a>
        @*<a href="GeneratedFiles" class="btn" id="generatedFiles">Files</a>*@
    </div>

    <div class="modal fade" id="visualization">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    
                    <h4 class="modal-title">Visualization</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    
                    1. Select display type:
                    <select id="treeType">
                        <option value="list">expandable list</option>
                        <option value="dendrogram">dendrogram</option>
                        <option value="verticalDendrogram">vertical dendrogram</option>
                    </select>
                    <p id="viewoptions">
                        &nbsp; &nbsp; &nbsp; &nbsp; Options (change forces refresh):
                        Attributes <input type="checkbox" id="attributes" name="attributes">
                        &nbsp; &nbsp; Objects: <input type="checkbox" id="objects"
                                                      name="objects"> &nbsp; Object Count: <input type="checkbox"
                                                                                                  id="objectCount" name="objectCount">
                    </p>
                    <p class="hint" id="dendHint">
                        Mouse wheel to zoom. Hold
                        click and move mouse to move tree
                    </p>
                </div>

                <div class="modal-body" id="tree-container">

                </div>

                <div class="modal-footer">

                </div>

            </div>
        </div>
    </div>



    <!--<span>-->
    @*2. Select a valid JSON file and upload/draw: <input type="file" id="files" />*@
    <!--<button id="upload">Upload->Draw Tree</button>
    </span>
    <span class="hint" id="verticalHint">
        Mouse over node to see
        attribute and object information
    </span>-->
</div>

<script>


    $(document).ready(function () {
        $('#FCATreeTool').show();
        $("#viewoptions").show();
        $("#dendHint").hide();
        $("#verticalHint").hide();

        $('#objects').val(this.checked);

        $("select#treeType").on('change', function () {

            if ($("#treeType").val() == "verticalDendrogram") {
                $("#viewoptions").hide();
            } else {
                $("#viewoptions").show();
            }
            ;

            if ($("#treeType").val() == "list") {
                $(".hint").hide();
            } else {
                $(".hint").show();
            };
            reload(false);
        });

        $(':checkbox').change(function () {
            reload(false);
        });

    });

    var fileInput = $('#files');
    var visualizeButton = $('#visualize');

    //function GetAsync(theUrl, callback) {
    //    var xmlHttp = new XMLHttpRequest();
    //    xmlHttp.onreadystatechange = function () {
    //        if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
    //            callback(xmlHttp.responseText);
    //    }
    //    xmlHttp.open("GET", theUrl, true); // true for asynchronous 
    //    xmlHttp.send(null);
    //    return xmlHttp.responseText;
    //}

    //async function fetchJSONAsync(url) {
    //    var response = await fetch(url);
    //    //var data = await response.json();
    //    console.log(response.json());
    //    return response.formData;
    //}

    function Get(yourUrl) {
        var Httpreq = new XMLHttpRequest();
        // a new request
        Httpreq.open('GET', yourUrl, false);
        Httpreq.send(null);
        return Httpreq.responseText;
    }

    //function loadDoc(url) {
    //    var xhttp = new XMLHttpRequest();
    //    xhttp.onreadystatechange = function () {
    //        if (this.readyState == 4 && this.status == 200) {
    //            return this.responseText;
    //            //document.getElementById("demo").innerHTML = this.responseText;
    //        }
    //    };
    //    xhttp.open("GET", url, true);
    //    xhttp.send();
    //    //return this.responseText;
    //}

    function reload(visualize) {

        $('#FCATreeTool').show();
        //var input;
        //console.log("in reload upload " + visualize);
        //if (!window.FileReader) {
        //    alert('Your browser is not supported')
        //}
        //input = fileInput.get(0);
        // Create a reader object
        var reader = new FileReader();
        var jsonFile = Get('GetFile'); 
        
        if (jsonFile != null) {
            var myblob = new Blob([jsonFile], {
                type: 'application/json'
            });
            reader.readAsText(myblob);

            if ($("#treeType").val() == "list") {
                $(reader).on('load', drawFileTree);
            } else if ($("#treeType").val() == "verticalDendrogram") {
                $(reader).on('load', drawVerticalDendrogram);

            } else {
                $(reader).on('load', drawDendrogram);
            }
        } else {
            if (visualize)
                alert('Please select a valid json file before continuing');
        }
    };
    visualizeButton.on('click', reload);

</script>







